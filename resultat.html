<html>
   <head>
   <script>
   // Do not remove the import statements below
import * as powerbiClient from 'powerbi-client';
import * as models from 'powerbi-models';

let loadedResolve: any, reportLoaded = new Promise((res) => { loadedResolve = res; });
let renderedResolve: any, reportRendered = new Promise((res) => { renderedResolve = res; });
const powerbi: powerbiClient.service.Service = window["powerbi"];

async function embedPowerBIReport() {
    /*-----------------------------------------------------------------------------------+
    |    Don't change these values here: access token, embed URL and report ID.          |
    |    To make changes to these values:                                                |
    |    1. Save any other code changes to a text editor, as these will be lost.         |
    |    2. Select 'Start over' from the ribbon.                                         |
    |    3. Select a report or use an embed token.                                       |
    +-----------------------------------------------------------------------------------*/
    // Read embed application token
    let accessToken: string = EMBED_ACCESS_TOKEN;

    // Read embed URL
    let embedUrl: string = EMBED_URL;

    // Read report Id
    let embedReportId: string = REPORT_ID;

    // Read embed type from radio
    let tokenType = TOKEN_TYPE;

    // We give All permissions to demonstrate switching between View and Edit mode and saving report.
    let permissions: models.Permissions = models.Permissions.All;

    // Create the embed configuration object for the report
    // For more information see https://go.microsoft.com/fwlink/?linkid=2153590
    let config: models.IReportEmbedConfiguration = {
        type: 'report',
        tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
        accessToken: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IlhSdmtvOFA3QTNVYVdTblU3Yk05blQwTWpoQSIsImtpZCI6IlhSdmtvOFA3QTNVYVdTblU3Yk05blQwTWpoQSJ9.eyJhdWQiOiJodHRwczovL2FuYWx5c2lzLndpbmRvd3MubmV0L3Bvd2VyYmkvYXBpIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvYmEyMGNlM2ItNzYwMi00ZTAxLTk1ZDAtNGEyNzBhZWMyOWFlLyIsImlhdCI6MTcxMTExMTAyNCwibmJmIjoxNzExMTExMDI0LCJleHAiOjE3MTExMTU0NDksImFjY3QiOjAsImFjciI6IjEiLCJhaW8iOiJBVFFBeS84V0FBQUFTcWVRUjBCa05QOFVvSlFnL0NKUTFwZ2FENGxXWjNjcVZtd2JjRkV1OHU4anVNSnJGQ3JDL2VzRE4xNG1JVTBlIiwiYW1yIjpbInB3ZCIsInJzYSJdLCJhcHBpZCI6IjIzZDhmNmJkLTFlYjAtNGNjMi1hMDhjLTdiZjUyNWM2N2JjZCIsImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiMTUzMDY0NjEtMDYyMi00MmZlLWFiYTEtYzQ4NTk5MDY0MzVmIiwiZmFtaWx5X25hbWUiOiJrYXJpbSIsImdpdmVuX25hbWUiOiJuZGlheWUiLCJpcGFkZHIiOiI5My42Ni4zLjExIiwibmFtZSI6Im5kaWF5ZSBrYXJpbSIsIm9pZCI6IjFlZjk0YjdjLTBmNDgtNDRjNy04NDk5LTQ0OTU3Zjc4ZjNiZCIsInB1aWQiOiIxMDAzMjAwMDk5QjcyOTI5IiwicmgiOiIwLkFUc0FPODRndWdKMkFVNlYwRW9uQ3V3cHJna0FBQUFBQUFBQXdBQUFBQUFBQUFBN0FLTS4iLCJzY3AiOiJBcHAuUmVhZC5BbGwgQ2FwYWNpdHkuUmVhZC5BbGwgQ2FwYWNpdHkuUmVhZFdyaXRlLkFsbCBDb250ZW50LkNyZWF0ZSBEYXNoYm9hcmQuUmVhZC5BbGwgRGFzaGJvYXJkLlJlYWRXcml0ZS5BbGwgRGF0YWZsb3cuUmVhZC5BbGwgRGF0YWZsb3cuUmVhZFdyaXRlLkFsbCBEYXRhc2V0LlJlYWQuQWxsIERhdGFzZXQuUmVhZFdyaXRlLkFsbCBHYXRld2F5LlJlYWQuQWxsIEdhdGV3YXkuUmVhZFdyaXRlLkFsbCBQaXBlbGluZS5EZXBsb3kgUGlwZWxpbmUuUmVhZC5BbGwgUGlwZWxpbmUuUmVhZFdyaXRlLkFsbCBSZXBvcnQuUmVhZC5BbGwgUmVwb3J0LlJlYWRXcml0ZS5BbGwgU3RvcmFnZUFjY291bnQuUmVhZC5BbGwgU3RvcmFnZUFjY291bnQuUmVhZFdyaXRlLkFsbCBUZW5hbnQuUmVhZC5BbGwgVGVuYW50LlJlYWRXcml0ZS5BbGwgVXNlclN0YXRlLlJlYWRXcml0ZS5BbGwgV29ya3NwYWNlLlJlYWQuQWxsIFdvcmtzcGFjZS5SZWFkV3JpdGUuQWxsIiwic2lnbmluX3N0YXRlIjpbImttc2kiXSwic3ViIjoiX2JfZkZNaC1lRFVLeUd1MHNTbHJlYU84bm0xOG5CcDdFU2dKR2NyQjU1WSIsInRpZCI6ImJhMjBjZTNiLTc2MDItNGUwMS05NWQwLTRhMjcwYWVjMjlhZSIsInVuaXF1ZV9uYW1lIjoibmRpYXllQGV1cm9wZWNvbnN1bHRpbmcubmV0IiwidXBuIjoibmRpYXllQGV1cm9wZWNvbnN1bHRpbmcubmV0IiwidXRpIjoieDdJamlXalJNVVNQcFNVcmxQcE9BQSIsInZlciI6IjEuMCIsIndpZHMiOlsiYjc5ZmJmNGQtM2VmOS00Njg5LTgxNDMtNzZiMTk0ZTg1NTA5Il0sInhtc19wbCI6ImVuLVVTIn0.DriURK6BM23xSyb2jtpl3sH_SaMVwwr_Qjb-Iy4huxfm3L5PmIyClcEs8K9maz6t334dCroZNARl5E6N7xGoj6tihxuirJrJxc5zSWlUjEjmTMTVqx6ikYmd7a77GlWvhtGMy-UlGjaJ9r_CuiCRM901Hp0j5drl0hFCyLnd2KbDtaMd-VFC87w06xa1TR-6yvluUr9eQKYSmELA4U6vDWRxQxt2FYwbTQ7jF8eskg-zVuawJiqDulb8SksUWUKceLpjS4a4p1OQh3kcrjHaloEanQWITluBVlw7ZtsevjpX7sGF3zJVbgVu6fOuEUQE8dlyayKo6TZfYdzgFzrHeA',
        embedUrl: 'https://app.powerbi.com/reportEmbed?reportId=490a0b3b-f807-4976-aa16-0a6294598eed&autoAuth=true&ctid=ba20ce3b-7602-4e01-95d0-4a270aec29ae',
        id: '490a0b3b-f807-4976-aa16-0a6294598eed',
        permissions: permissions,
        settings: {
            panes: {
                filters: {
                    visible: true
                },
                pageNavigation: {
                    visible: true
                }
            }
        }
    };

    // Get a reference to the embedded report HTML element
    let embedContainer: HTMLElement = document.getElementById('embedContainer');

    // Embed the report and display it within the div container.
    report = powerbi.embed(embedContainer, config) as powerbiClient.Report;

    // report.off removes all event handlers for a specific event
    report.off("loaded");

    // report.on will add an event handler
    report.on("loaded", function () {
        loadedResolve();
        report.off("loaded");
    });

    // report.off removes all event handlers for a specific event
    report.off("error");

    report.on("error", function (event: powerbiClient.service.ICustomEvent<any>) {
        console.log(event.detail);
    });

    // report.off removes all event handlers for a specific event
    report.off("rendered");

    // report.on will add an event handler
    report.on("rendered", function () {
        renderedResolve();
        report.off("rendered");
    });
}

embedPowerBIReport();
await reportLoaded;

// Insert here the code you want to run after the report is loaded

await reportRendered;

// Insert here the code you want to run after the report is rendered



    
    
</script>
</head>
</html>